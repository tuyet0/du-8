"use strict";(self.webpackChunkdu_6=self.webpackChunkdu_6||[]).push([[299],{2299:function(e,t,n){n.r(t),n.d(t,{default:function(){return D}});var r=n(4165),a=n(1413),s=n(5861),i=n(9439),c=n(2791),u=n(6770),l=n.n(u),o=n(1134),d=n(9646),p=n(8119),h=n(9501),m=n(6356),f=n(3031),g=n(9248),x=n(3453),Z=n(4961),v=n(1776),j=n(3585),b=n(1418),y=n(1087),k=n(5179),w=n(2481),E=n(2077),N=n(9085),C=n(1243),S=n(333),P=n.n(S),U=n(184);u.Quill.register("modules/imageUploader",k.Z);var D=function(){var e=(0,y.lr)(),t=(0,i.Z)(e,1)[0].get("id"),n=(0,c.useState)([]),u=(0,i.Z)(n,2),k=u[0],S=u[1],D=(0,c.useState)(""),I=(0,i.Z)(D,2),J=I[0],L=I[1],T=(0,c.useState)(""),R=(0,i.Z)(T,2),V=R[0],A=R[1],O=(0,o.cI)({mode:"onChange",defaultValues:{status:1,title:"",slug:"",hot:!1,image:"",category:{},user:{}}}),_=O.control,F=O.watch,Q=O.setValue,G=O.getValues,q=O.handleSubmit,H=O.reset,M=O.formState.isSubmitting,z=F("status"),B=F("hot"),K=G("image_name"),W=G("image"),X=(0,v.Z)(Q,G,K,(function(){return re.apply(this,arguments)})),Y=X.image,$=X.setImage,ee=X.progress,te=X.handleSelectImage,ne=X.handleDeleteImage;function re(){return(re=(0,s.Z)((0,r.Z)().mark((function e(){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,w.JU)(E.db,"Posts",t),e.next=3,(0,w.r7)(n,{image_name:""});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ae=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.slug=P()(n.slug||n.title,{lower:!0}),s=(0,w.JU)(E.db,"Posts",t),e.next=4,(0,w.r7)(s,(0,a.Z)((0,a.Z)({},n),{},{image:Y,content:J}));case 4:N.Am.success("Update post successfully");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,w.JU)(E.db,"Categories",t.id),e.next=3,(0,w.QT)(n);case 3:s=e.sent,Q("category",(0,a.Z)({id:s.id},s.data())),A(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){function e(){return(e=(0,s.Z)((0,r.Z)().mark((function e(){var t,n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=(0,w.hJ)(E.db,"Categories"),s=(0,w.IO)(n),e.next=5,(0,w.PL)(s);case 5:e.sent.forEach((function(e){t.push((0,a.Z)({id:e.id},e.data()))})),S(t);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,c.useEffect)((function(){$(W)}),[W,$]),(0,c.useEffect)((function(){function e(){return(e=(0,s.Z)((0,r.Z)().mark((function e(){var n,a,s,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:return n=(0,w.JU)(E.db,"Posts",t),e.next=5,(0,w.QT)(n);case 5:(a=e.sent).data&&(H(a.data()),A((null===(s=a.data())||void 0===s?void 0:s.category)||""),L((null===(i=a.data())||void 0===i?void 0:i.content)||""));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,H]);var ie=(0,c.useMemo)((function(){return{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}],["link","image"]],imageUploader:{upload:function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",t),e.next=4,(0,C.Z)({method:"post",url:"https://api.imgbb.com/1/upload?key=d7da753c0765f00dc045ddeb36929aa5",data:n,headers:{"Content-Type":"multipart/form-data"}});case 4:return a=e.sent,e.abrupt("return",a.data.data.url);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}}),[]);return t?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(b.Z,{title:"Update post",desc:"Update post",className:"dashboard-heading"}),(0,U.jsxs)("form",{onSubmit:q(ae),children:[(0,U.jsxs)("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:[(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Title"}),(0,U.jsx)(g.Z,{control:_,placeholder:"Enter your title",name:"title"})]}),(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Slug"}),(0,U.jsx)(g.Z,{control:_,placeholder:"Enter your slug",name:"slug"})]})]}),(0,U.jsxs)("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:[(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Image"}),(0,U.jsx)(f.Z,{image:Y,progress:ee,type:"file",name:"image",onChange:te,handleDeleteImage:ne})]}),(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Category"}),(0,U.jsxs)(h.L,{children:[(0,U.jsx)(h.L.Select,{placeholder:"Select the category"}),(0,U.jsx)(h.L.List,{children:k.map((function(e){return(0,U.jsx)(h.L.Option,{onClick:function(){return se(e)},children:e.name},e.id)}))})]}),(null===V||void 0===V?void 0:V.name)&&(0,U.jsx)("span",{className:"inline-block p-3 mt-1 text-sm font-medium bg-green-200 rounded-lg color-green",children:null===V||void 0===V?void 0:V.name})]})]}),(0,U.jsxs)("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:[(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Feature Hot"}),(0,U.jsx)(Z.Z,{on:!0===B,onClick:function(){return Q("hot",!B)}})]}),(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Status"}),(0,U.jsxs)("div",{className:"flex items-center gap-x-5",children:[(0,U.jsx)(p.Z,{name:"status",control:_,checked:Number(z)===j.cf.APPROVED,value:j.cf.APPROVED,children:"Approved"}),(0,U.jsx)(p.Z,{name:"status",control:_,checked:Number(z)===j.cf.PENDING,value:j.cf.PENDING,children:"Pending"}),(0,U.jsx)(p.Z,{name:"status",control:_,checked:Number(z)===j.cf.REJECTED,value:j.cf.REJECTED,children:"Reject"})]})]})]}),(0,U.jsx)("div",{className:"mb-10",children:(0,U.jsxs)(m.Z,{children:[(0,U.jsx)(x.Z,{children:"Content"}),(0,U.jsx)("div",{className:"w-full bg-white entry-content",children:(0,U.jsx)(l(),{modules:ie,theme:"snow",value:J,onChange:L})})]})}),(0,U.jsx)(d.Z,{isLoading:M,disabled:M,kind:"primary",type:"submit",className:"mx-auto w-[250px]",children:"Update post"})]})]}):null}}}]);
//# sourceMappingURL=299.35cbdce0.chunk.js.map